# ********RoostGPT********

# Test generated by RoostGPT for test Oct-24-Gemini-org using AI Type Gemini AI and AI Model gemini-2.5-pro
# 
# Test file generated for /colleges/post_post for http method type POST 
# RoostTestHash=f378b49176
# 
# 

# ********RoostGPT********
import pytest
import requests
from typing import Dict, Any

# Endpoint for adding a new college
ADD_COLLEGE_ENDPOINT = "/colleges/post"

# --- Test Data ---

# Valid college data payloads based on the API specification examples
VALID_COLLEGE_PAYLOADS = [
    (
        "Harvard",
        {
            "newCollege": {
                "name": "Harvard University",
                "location": "Cambridge, Massachusetts",
                "established": 1636,
            }
        },
    ),
    (
        "Stanford",
        {
            "newCollege": {
                "name": "Stanford University",
                "location": "Stanford, California",
                "established": 1885,
            }
        },
    ),
    (
        "MIT",
        {
            "newCollege": {
                "name": "Massachusetts Institute of Technology",
                "location": "Cambridge, Massachusetts",
                "established": 1861,
            }
        },
    ),
]

# Invalid college data payloads for testing error scenarios
INVALID_COLLEGE_PAYLOADS = [
    (
        "missing_name",
        {"newCollege": {"location": "Someplace, USA", "established": 2000}},
        "Missing 'name' field",
    ),
    (
        "missing_location",
        {"newCollege": {"name": "Incomplete College", "established": 2001}},
        "Missing 'location' field",
    ),
    (
        "missing_established",
        {"newCollege": {"name": "Timeless College", "location": "Anywhere, USA"}},
        "Missing 'established' field",
    ),
    (
        "invalid_type_for_established",
        {
            "newCollege": {
                "name": "Type Error University",
                "location": "Validation Ville",
                "established": "nineteen-ninety",
            }
        },
        "Invalid data type for 'established'",
    ),
    (
        "empty_newCollege_object",
        {"newCollege": {}},
        "Empty 'newCollege' object",
    ),
    (
        "null_values",
        {
            "newCollege": {
                "name": None,
                "location": None,
                "established": None,
            }
        },
        "Null values for required fields",
    ),
]


# --- Test Cases ---

@pytest.mark.parametrize("college_id, payload", VALID_COLLEGE_PAYLOADS)
def test_add_college_success(api_helper, college_id: str, payload: Dict[str, Any]):
    """
    Tests the successful creation of a new college using valid data.

    Covers:
    - Happy path scenario for POST /colleges/post.
    - Validates the 200 OK status code.
    - Validates the response body structure and content.
    - Validates the Content-Type header.
    """
    # Act: Send a POST request to add a new college
    response = api_helper.make_request(
        method="POST",
        endpoint=ADD_COLLEGE_ENDPOINT,
        json=payload,
    )

    # Assert: Verify the response
    assert response.status_code == 200, f"Expected status code 200, but got {response.status_code}"
    assert "application/json" in response.headers.get(
        "Content-Type", ""
    ), "Response Content-Type should be application/json"

    response_data = response.json()

    # Assert: Validate the response schema
    assert "Colleges" in response_data, "Response JSON should contain a 'Colleges' key"
    college_info = response_data["Colleges"]
    assert isinstance(college_info, dict), "'Colleges' should be a dictionary"

    # Assert: Validate the response data matches the request payload
    expected_college_info = payload["newCollege"]
    assert (
        college_info.get("name") == expected_college_info["name"]
    ), "Response 'name' does not match request"
    assert (
        college_info.get("location") == expected_college_info["location"]
    ), "Response 'location' does not match request"
    assert (
        college_info.get("established") == expected_college_info["established"]
    ), "Response 'established' does not match request"


@pytest.mark.parametrize("scenario_id, payload, description", INVALID_COLLEGE_PAYLOADS)
def test_add_college_invalid_payload(api_helper, scenario_id: str, payload: Dict[str, Any], description: str):
    """
    Tests server response when trying to create a college with invalid or incomplete data.

    Covers:
    - Error scenarios for POST /colleges/post.
    - Payloads with missing required fields.
    - Payloads with incorrect data types.
    - Assumes a 400 Bad Request response for client-side errors.
    """
    # Act: Send a POST request with an invalid payload
    response = api_helper.make_request(
        method="POST",
        endpoint=ADD_COLLEGE_ENDPOINT,
        json=payload,
    )

    # Assert: Verify that the server rejects the request
    # A 400 Bad Request is the expected response for malformed client requests.
    assert (
        response.status_code == 400
    ), f"Expected status code 400 for '{description}', but got {response.status_code}"


def test_add_college_empty_request_body(api_helper):
    """
    Tests the API's response to a POST request with an empty JSON object as the body.
    """
    # Act: Send a POST request with an empty JSON object
    response = api_helper.make_request(
        method="POST",
        endpoint=ADD_COLLEGE_ENDPOINT,
        json={},
    )

    # Assert: Verify the server rejects the request
    assert (
        response.status_code == 400
    ), f"Expected status code 400 for an empty request body, but got {response.status_code}"


def test_add_college_no_request_body(api_helper):
    """
    Tests the API's response to a POST request with no body.
    """
    # Act: Send a POST request with no JSON body
    response = api_helper.make_request(
        method="POST",
        endpoint=ADD_COLLEGE_ENDPOINT,
        json=None,
    )

    # Assert: Verify the server rejects the request
    assert (
        response.status_code == 400
    ), f"Expected status code 400 for a missing request body, but got {response.status_code}"

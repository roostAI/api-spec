# ********RoostGPT********

# Test generated by RoostGPT for test weather_api_test using AI Type Open AI and AI Model gpt-4o
# 
# Feature file generated for /search.json_get for http method type GET 
# RoostTestHash=72ffe69306
# 
# 

# ********RoostGPT********
Feature: Search/Autocomplete API Tests

  Background:
    * def baseURL = karate.properties['WEATHER_API_BASE_URL'] || karate.properties['API_HOST']
    * url baseURL
    * def authToken = karate.properties['AUTH_TOKEN'] || karate.properties['key']
    * header Accept = 'application/json'

  Scenario Outline: Validate successful search with valid query
    Given path '/v1/search.json'
    And param key = authToken
    And param q = '<query>'
    When method GET
    Then status 200
    And match response == '#[]'
    And match each response[*].id == '#number'
    And match each response[*].name == '#string'
    And match each response[*].region == '#string'
    And match each response[*].country == '#string'
    And match each response[*].lat == '#number'
    And match each response[*].lon == '#number'
    And match each response[*].url == '#string'

    Examples:
      | query         |
      | 'London'      |
      | '90210'       |
      | '51.52,-0.12' |

  Scenario: Validate error response when query parameter 'q' is missing
    Given path '/v1/search.json'
    And param key = authToken
    When method GET
    Then assert responseStatus != 200
    And match response.code == 1003
    And match response.message == '#string'

  Scenario: Validate error response when API key is missing
    Given path '/v1/search.json'
    And param q = 'London'
    When method GET
    Then assert responseStatus != 200
    And match response.code == 1002
    And match response.message == '#string'

  Scenario: Validate error response when API key is invalid
    Given path '/v1/search.json'
    And param key = 'invalid_key'
    And param q = 'London'
    When method GET
    Then assert responseStatus != 200
    And match response.code == 2006
    And match response.message == '#string'

  Scenario: Validate error response when API key has exceeded quota
    Given path '/v1/search.json'
    And param key = authToken
    And param q = 'London'
    When method GET
    Then assert responseStatus != 200
    And match response.code == 2007
    And match response.message == '#string'
